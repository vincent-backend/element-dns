(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2eca21c"],{2399:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{},[e("div",{staticClass:"domin-manage"},[t._v("监控列表")]),e("div",{staticClass:"header-container"},[e("el-button",{on:{click:t.stopMon}},[t._v("暂停监控")]),e("el-button",{on:{click:t.startMon}},[t._v("继续监控")]),e("el-button",{on:{click:t.delMon}},[t._v("删除监控")])],1),e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"small","header-cell-style":t.fun,stripe:"",data:t.monList,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"50"}}),e("el-table-column",{attrs:{prop:"domain",label:"域名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.watch(s.row)}}},[t._v(t._s(s.row.domain))])]}}])}),e("el-table-column",{attrs:{width:"180",prop:"ip",label:"IP"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.ip))])]}}])}),e("el-table-column",{attrs:{width:"100",prop:"port",label:"端口"}}),e("el-table-column",{attrs:{width:"100",prop:"freq",label:"频率"}}),e("el-table-column",{attrs:{width:"130",prop:"https",label:"监控方式"},scopedSlots:t._u([{key:"default",fn:function(s){return[0==s.row.https?e("el-tag",{attrs:{type:"success"}},[t._v("http")]):1==s.row.https?e("el-tag",{attrs:{type:"success"}},[t._v("https")]):e("el-tag",{attrs:{type:"success"}},[t._v("端口检测")])]}}])}),e("el-table-column",{attrs:{width:"130",prop:"act",label:"切换规则"},scopedSlots:t._u([{key:"default",fn:function(s){return[0==s.row.act?e("span",[t._v("不切换")]):t._e(),1==s.row.act?e("span",[t._v("暂停解析")]):t._e(),2==s.row.act?e("span",[t._v("切换备用")]):t._e(),3==s.row.act?e("span",[t._v("智能切换")]):t._e()]}}])}),e("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"通知方式",width:"230"},scopedSlots:t._u([{key:"default",fn:function(s){return[1==s.row.email?e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-s-promotion"}}):t._e(),1==s.row.sms?e("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-phone"}}):t._e(),""!=s.row.ns?e("span",[t._v(t._s(s.row.ns))]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"state","show-overflow-tooltip":"",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(s){return[0==s.row.state?e("el-tag",{attrs:{type:"success"}},[t._v("运行中")]):e("el-tag",{attrs:{type:"warning"}},[t._v("停止")])]}}])}),e("el-table-column",{attrs:{prop:"state","show-overflow-tooltip":"",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.watch(s.row)}}},[t._v("修改")])]}}])})],1),e("el-dialog",{attrs:{title:"设置修改",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{attrs:{model:t.form}},[e("el-form-item",{attrs:{label:"监控频率","label-width":t.formLabelWidth}},[e("el-radio-group",{model:{value:t.form.freq,callback:function(e){t.$set(t.form,"freq",e)},expression:"form.freq"}},t._l(t.freq,(function(s,a){return e("el-radio",{key:a,attrs:{label:s}},[t._v(t._s(s))])})),1)],1),e("el-form-item",{attrs:{label:"监控方式","label-width":t.formLabelWidth}},[e("el-radio",{attrs:{label:0},model:{value:t.form.https,callback:function(e){t.$set(t.form,"https",e)},expression:"form.https"}},[t._v("http")]),e("el-radio",{attrs:{label:1},model:{value:t.form.https,callback:function(e){t.$set(t.form,"https",e)},expression:"form.https"}},[t._v("https")]),e("el-radio",{attrs:{label:2},model:{value:t.form.https,callback:function(e){t.$set(t.form,"https",e)},expression:"form.https"}},[t._v("端口检测")])],1),2!=t.form.https?e("el-form-item",{attrs:{label:"主机域名","label-width":t.formLabelWidth}},[e("el-input",{staticStyle:{width:"220px"},attrs:{autocomplete:"off",disabled:!0},model:{value:t.form.domain,callback:function(e){t.$set(t.form,"domain",e)},expression:"form.domain"}})],1):t._e(),e("el-form-item",{attrs:{label:"IP地址","label-width":t.formLabelWidth}},[e("el-input",{staticStyle:{width:"220px"},attrs:{autocomplete:"off",disabled:!0},model:{value:t.form.ip,callback:function(e){t.$set(t.form,"ip",e)},expression:"form.ip"}})],1),e("el-form-item",{attrs:{label:"端口","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.port,callback:function(e){t.$set(t.form,"port",e)},expression:"form.port"}})],1),e("el-form-item",{attrs:{label:"切换规则","label-width":t.formLabelWidth}},[e("el-radio-group",{model:{value:t.form.act,callback:function(e){t.$set(t.form,"act",e)},expression:"form.act"}},[e("el-radio",{staticStyle:{"margin-bottom":"10px","margin-top":"15px"},attrs:{label:0}},[t._v("不对该域名记录做操作(不切换)")]),e("el-radio",{staticStyle:{"margin-bottom":"10px"},attrs:{label:1}},[t._v("自动暂停与智能切换(合适多机或负载均衡时用)")]),e("el-radio",{staticStyle:{"margin-bottom":"10px"},attrs:{label:2}},[t._v("切换到指定的备用IP(自定义切换)")])],1),2==t.form.act?e("el-input",{staticClass:"bian",staticStyle:{width:"250px"},model:{value:t.form.bip,callback:function(e){t.$set(t.form,"bip",e)},expression:"form.bip"}}):t._e()],1),e("el-form-item",{attrs:{label:"通知方式","label-width":t.formLabelWidth}},[e("el-checkbox",{attrs:{label:"邮件通知"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}}),e("el-checkbox",{attrs:{label:"短信通知"},model:{value:t.form.sms,callback:function(e){t.$set(t.form,"sms",e)},expression:"form.sms"}}),e("el-button",{staticStyle:{margin:"0px 20px"},attrs:{type:"text",size:"mini",icon:"el-icon-place"},on:{click:function(e){return t.selectNsc(t.nsc)}}}),1==t.nsc?e("el-input",{staticClass:"bian",staticStyle:{width:"250px"},attrs:{placeholder:"可指定邮箱或手机"},model:{value:t.form.ns,callback:function(e){t.$set(t.form,"ns",e)},expression:"form.ns"}}):t._e()],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.update}},[t._v("确 定")])],1)],1),e("div",{staticClass:"footer-page",staticStyle:{"margin-top":"20px"}},[e("el-pagination",{staticStyle:{width:"100%","text-align":"right"},attrs:{"current-page":t.currentPage,"page-sizes":[10,30,50,100,500,1e3],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.count,background:"","pager-count":5},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},o=[],i=(s("14d9"),{name:"",components:{},data(){return{freq:[],innerDrawer:!1,drawer:!1,monList:[],form:{id:"",oid:this.$route.query.oid,domain:"",ip:"",port:"80",https:"0",freq:"",act:0,bip:"",email:0,sms:0,ns:"",nsc:!1},nsc:!1,formLabelWidth:"80px",value:"",checked:!0,dialogFormVisible:!1,multipleSelection:[],currentPage:1,pagesize:10,count:0,loading:!1,id:0}},computed:{},watch:{},methods:{selectNsc(t){this.nsc=1!=t},watch(t){this.id=t.id,this.dialogFormVisible=!0,this.getmon()},getmon(){this.$request({url:"/mon/view",params:{id:this.id}}).then(t=>{0==t.data.rec&&(this.form=t.data.data,1==this.form.email?this.form.email=!0:this.form.email=!1,1==this.form.sms?this.form.sms=!0:this.form.sms=!1,""!=t.data.data.ns?this.nsc=!0:this.nsc=!1)})},update(){1==this.form.email?this.form.email=1:this.form.email=0,1==this.form.sms?this.form.sms=1:this.form.sms=0,this.$request({url:"/mon/add",params:this.form}).then(t=>{0==t.data.rec?(this.$message.success("修改成功"),this.getmon(),this.getMonList(),this.dialogFormVisible=!1):(1==this.form.email?this.form.email=!0:this.form.email=!1,1==this.form.sms?this.form.sms=!0:this.form.sms=!1,this.$message.error(t.data.msg))})},toggleAll(){this.$refs.multipleTable.toggleAllSelection()},fun({columnIndex:t}){return 8!==t?{height:"50px",background:"#0164F6",color:"#fff"}:8==t?{height:"50px",background:"#0164F6",color:"#fff","padding-right":"10px"}:void 0},toggleSelection(t){t?t.forEach(t=>{this.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(t){this.multipleSelection=t},startMon(t){var e=this.multipleSelection.map(t=>t.id);this.$request({url:"/mon/start",params:{id:e.toString()}}).then(t=>{0==t.data.rec?(this.$message.success("监控成功"),this.getMonList()):this.$message.error(t.data.msg)})},stopMon(){var t=this.multipleSelection.map(t=>t.id);this.$request({url:"/mon/stop",params:{id:t.toString()}}).then(t=>{0==t.data.rec?(this.$message.success("停止监控"),this.getMonList()):this.$message.error(t.data.msg)})},delMon(){var t=this.multipleSelection.map(t=>t.id);this.$confirm("是否删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$request({url:"/mon/del",params:{id:t.toString()}}).then(t=>{0==t.data.rec?(this.$message.success("删除成功"),this.getMonList()):this.$message.warning(t.data.msg)})}).catch(t=>{})},Towatch(){this.$router.push("/domin/list/watch")},Torecord(){this.$router.push("/domin/list/record")},Tocount(){this.$router.push("/domin/list/count")},handleSizeChange(t){this.pagesize=t,this.getMonList()},handleCurrentChange(t){this.currentPage=t,this.getMonList()},getMonList(){this.$request({url:"/mon/list",params:{page:this.currentPage,pagesize:this.pagesize}}).then(t=>{0==t.data.rec&&(this.monList=t.data.data.list,this.count=t.data.data.count,this.form.freq=this.monList.freq)})}},created(){this.getMonList(),this.$request({url:"/sys/dns/view"}).then(t=>{0==t.data.rec?this.freq=t.data.data.freq.split(","):this.$message.error(t.data.msg)})},mounted(){}}),l=i,r=(s("dc13"),s("2877")),n=Object(r["a"])(l,a,o,!1,null,"d77c55a8",null);e["default"]=n.exports},3949:function(t,e,s){},dc13:function(t,e,s){"use strict";s("3949")}}]);