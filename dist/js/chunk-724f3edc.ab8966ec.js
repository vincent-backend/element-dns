(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-724f3edc"],{"26d6":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{},[t("div",{staticClass:"main-title"},[e._v("节点管理")]),t("div",{staticClass:"header-container"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogFormVisible=!0}}},[e._v("添加节点")]),t("el-dialog",{attrs:{title:"添加节点",visible:e.addDialogFormVisible},on:{"update:visible":function(t){e.addDialogFormVisible=t}}},[t("el-form",{ref:"addDevice",attrs:{model:e.form,rules:e.deviceRules}},[t("el-form-item",{attrs:{label:"ip地址：","label-width":e.formLabelWidth,prop:"ip"}},[t("el-input",{staticStyle:{width:"280px"},attrs:{autocomplete:"off"},model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}})],1),t("el-form-item",{attrs:{label:"节点名称：","label-width":e.formLabelWidth,prop:"name"}},[t("el-input",{staticStyle:{width:"280px"},attrs:{type:"textarea"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDevice()}}},[e._v("确 定")])],1)],1),t("span",{staticStyle:{"margin-right":"20px","margin-left":"16px"}},[e._v("添加前，请先安装节点端软件")]),0==e.nin?t("div",{staticStyle:{"background-color":"#EEE",padding:"0 10px"}},[t("pre",[t("code",[e._v(e._s(e.text))])])]):e._e(),0==e.nin?t("el-button",{attrs:{type:"text",id:"copy_text"},on:{click:function(t){return e.copyActiveCode(t,e.text)}}},[e._v("点击复制")]):e._e()],1),e._v(" "),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"small","header-cell-style":e.fun,stripe:"",data:e.NodeList,"tooltip-effect":"dark"}},[t("el-table-column",{attrs:{width:"30"}}),t("el-table-column",{attrs:{prop:"ip",label:"IP地址",width:"180"}}),t("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":"",label:"节点名称",width:"200"}}),t("el-table-column",{attrs:{prop:"qps","show-overflow-tooltip":"",label:"解析数",width:"200"}}),t("el-table-column",{attrs:{prop:"note",label:"","show-overflow-tooltip":"",width:"120"}}),t("el-table-column",{attrs:{prop:"utime",label:"运行时间","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"state","show-overflow-tooltip":"",label:"运行状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(i){return[0==i.row.state?t("el-tag",{attrs:{type:"success"}},[e._v("正常")]):t("el-tag",{attrs:{type:"warning"}},[e._v("故障")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.Tocount(i.row.ip,i.row.id)}}},[e._v("资源")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.updateShow(i.row)}}},[e._v("修改")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.delDevice(i.row)}}},[e._v("删除")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.syncDevice(i.row)}}},[e._v("同步")]),t("el-dialog",{attrs:{title:"修改节点名称",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.deviceForm,rules:e.deviceRules}},[t("el-form-item",{attrs:{label:"ip地址：","label-width":e.formLabelWidth,prop:"ip"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.deviceForm.ip,callback:function(t){e.$set(e.deviceForm,"ip",t)},expression:"deviceForm.ip"}})],1),t("el-form-item",{attrs:{label:"节点名称：","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.deviceForm.name,callback:function(t){e.$set(e.deviceForm,"name",t)},expression:"deviceForm.name"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateDevice()}}},[e._v("确 定")])],1)],1)],1)]}}])})],1),t("div",{staticClass:"footer-page",staticStyle:{"margin-top":"20px","text-align":"right"}},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,30,50,100,500,1e3],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.count,background:"","pager-count":5},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},o=[],s=(i("14d9"),i("b311")),r=i.n(s),l={name:"",components:{Clipboard:r.a},data(){return{text:"cd /tmp;wget http://dl.funnulldns.com/files/wddns/install_node.sh;sh install_node.sh",form:{name:"",ip:""},deviceRules:{ip:[{required:!0,message:"请输入ip",trigger:"blur"}]},multipleSelection:[],currentPage:1,formLabelWidth:"120px",deviceForm:{},dialogFormVisible:!1,addDialogFormVisible:!1,NodeList:[],count:0,pagesize:10,nin:0}},computed:{},watch:{},methods:{copyActiveCode(e,t){const i=new r.a(e.target,{text:()=>t});i.on("success",e=>{this.$message({type:"success",message:"复制成功"}),i.off("error"),i.off("success"),i.destroy()}),i.on("error",e=>{this.$message({type:"waning",message:"该浏览器不支持自动复制"}),i.off("error"),i.off("success"),i.destroy()}),i.onClick(e)},addDevice(){this.$request({url:"/domain/node/add",params:this.form}).then(e=>{0==e.data.rec?(this.$message.success("添加成功"),this.addDialogFormVisible=!1,this.getNodeList(),this.$refs.addDevice.resetFields()):(this.$message.error(e.data.msg),this.addDialogFormVisible=!1,this.$refs.addDevice.resetFields())})},delDevice(e){this.$confirm("删除节点, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$request({url:"/domain/node/del",params:{id:e.id}}).then(e=>{0==e.data.rec?(this.$message.success("删除成功"),this.getNodeList()):this.$message.error(e.data.msg)})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},syncDevice(e){this.$confirm("如发现节点数据不完整时可操作，一般不需操作！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$request({url:"/domain/node/sync",params:{id:e.id}}).then(e=>{0==e.data.rec?this.$message.success(e.data.msg):this.$message.error(e.data.msg)})}).catch(()=>{this.$message({type:"info",message:"已取消同步"})})},updateShow(e){this.dialogFormVisible=!0,this.deviceForm=e},updateDevice(e){this.$request({url:"/domain/node/add",params:this.deviceForm}).then(e=>{0==e.data.rec?(this.$message.success("修改成功"),this.dialogFormVisible=!1,this.getNodeList()):this.$message.error(e.data.msg)})},getNodeList(){this.$request({url:"/domain/node/list",params:{page:this.currentPage,pagesize:this.pagesize}}).then(e=>{0==e.data.rec?(this.count=e.data.data.count,this.NodeList=e.data.data.list):this.$message.error(e.data.msg)})},fun({columnIndex:e}){return 7!==e?{height:"49px",background:"#0164F6",color:"#fff"}:7==e?{height:"49px","text-align":"center",background:"#0164F6",color:"#fff","padding-right":"10px"}:void 0},Tocount(e,t){this.$router.push("/node/top?ip="+e+"&id="+t)},handleSizeChange(e){this.pagesize=e,this.getNodeList()},handleCurrentChange(e){this.currentPage=e,this.getNodeList()}},created(){this.nin=localStorage.getItem("nin"),1==this.nin&&(this.text=""),this.getNodeList()},mounted(){}},n=l,c=(i("5f65"),i("2877")),d=Object(c["a"])(n,a,o,!1,null,"d2a4320a",null);t["default"]=d.exports},"5e8a":function(e,t,i){},"5f65":function(e,t,i){"use strict";i("5e8a")}}]);